flowchart TD
    %% ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 1  FRONT‚ÄëEND  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    subgraph FE["üñ•Ô∏è  Front‚Äëend (React¬†19 + Vite)"]
        direction TB
        FE0["User types prompt  
              ‚¨áÔ∏è drags ‚â§50‚ÄØfiles (‚â§100‚ÄØMB each)"] --> FE1
        FE1["ContextUploader  
            ‚Ä¢ tus‚Äëjs resumable upload  
            ‚Ä¢ shows thumbnails + progress"] --> FE2
        FE2["POST /api/files  
            returns file_ids[]"] --> FE3
        FE3["POST /api/chat {prompt, mode, file_ids}"] --> FE4
        FE4["WebSocket /ws/{trace_id}  
            üîÑ AgentTimeline + ChatMessages  
            streams Node events"] --> FE5
        FE5["DownloadMenu  
            DOCX / PDF / PPT / ZIP  
            presigned URL"] --> FE6
        FE6["WalletButton (Dynamic.xyz)  
            Coinbase Pay ‚úö PayStack"]        
    end

    %% ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2  FASTAPI CORE  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    FE3 --> A_INTENT

    subgraph A_INTENT["Intent Layer"]
        A1["enhanced_user_intent"] --> A2
        A2["intelligent_intent_analyzer"] --> A3
        A3["user_intent (fallback)"]
    end

    A_INTENT --> B_PLAN

    subgraph B_PLAN["Planning Layer"]
        B1["planner"] -->|select graph YAML| B2
        B2["methodology_writer (if research)"]
        B2 --> B3["loader (seed docs)"]
    end

    %% ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  FILE¬†PRE‚ÄëPROCESSING (CELERY)  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    FE1 -. async .-> C_EMBED

    subgraph C_EMBED["File Chunk & Embed  (Celery)"]
        direction TB
        C1["chunk_splitter  
            ‚Ä¢ PDF 1‚ÄØ400‚ÄØchar windows  
            ‚Ä¢ DOC/TXT by paragraph  
            ‚Ä¢ images ‚Üí Gemini¬†Vision caption  
            ‚Ä¢ audio ‚Üí Whisper transcript"] --> C2
        C2["embedding_service  
            ‚Üí Supabase¬†pgvector"] --> C3
        C3["vector_storage"],
        style C_EMBED stroke-dasharray: 4 4
    end

    %% ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 3  RUNTIME GRAPH  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    B_PLAN --> C_RESEARCH

    subgraph C_RESEARCH["Research Swarm"]
        C_R0["search_base + search_*"] --> C_R1
        C_R1["research_swarm/* specialists"] --> C_R2
        C_R2["source_filter"] --> C_R3
        C_R3["source_verifier"] --> C_R4
        C_R4["prisma_filter"] --> C_R5
        C_R5["privacy_manager"]
    end

    C_RESEARCH --> D_AGG

    subgraph D_AGG["Aggregation & RAG"]
        D1["aggregator"] --> D2["rag_summarizer  
        üîç pgvector similarity(top 8)"]
        D2 --> D3["memory_retriever"]
        D3 --> D4["memory_writer"]
    end

    D_AGG --> E_AUTHOR

    subgraph E_AUTHOR["Writing Swarm"]
        E1["writer (Gemini‚ÄØ2.5‚ÄØPro) üöÄ  
            streams paragraphs"] --> E2
        E2["writing_swarm helpers  
             ‚Ä¢ academic_tone  
             ‚Ä¢ clarity_enhancer  
             ‚Ä¢ structure_optimizer  
             ‚Ä¢ style_adaptation"] --> E3
        E3["citation_master"]
    end

    E_AUTHOR --> F_FORMAT

    subgraph F_FORMAT["Formatting¬†/ QA"]
        F1["formatter_advanced"] --> F2
        F2["citation_audit"] --> F3
        F3["qa_swarm/*"] --> F4
        F4["evaluator"] --> F5["evaluator_advanced"]
    end

    F_FORMAT --> G_META

    subgraph G_META["Meta / Recovery"]
        G1["swarm_intelligence_coordinator"] --> G2
        G2["emergent_intelligence_engine"] --> G3
        G3["fail_handler_advanced  
            ‚Ü∫ retry w/ cheaper model"] --> G4
        G4["source_fallback_controller"] --> G5["synthesis"]
    end

    G_META --> H_DERIV

    subgraph H_DERIV["Derivatives & Compliance"]
        H1["slide_generator"] --> H2
        H2["derivatives (charts, infographics)"] --> H3
        H3["turnitin_advanced  
             ‚Ä¢ Celery poll ‚Üí similarity"] --> H4
        H4["arweave (optional)"]
    end

    H_DERIV --> I_RESP

    subgraph I_RESP["üì§  UnifiedResponse"]
        I1["JSON -> /api/chat response"] --> I2["WebSocket events  
                ‚Ä¢ stream  
                ‚Ä¢ cost_usd  
                ‚Ä¢ plagiarism_score  
                ‚Ä¢ derivative_ready"]
    end

    %% ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SUPPORTING SERVICES (SIDE‚ÄëCHANNELS) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    subgraph S1["Redis / Cost & Cache"]
        S1a["llm_service ‚Üí cache(prompt,model)"] 
        S1b["token_tracker ‚Üí usd ledger"]
    end
    S1a --> E_AUTHOR
    S1a --> C_RESEARCH
    S1b --> I_RESP

    subgraph S2["Admin & Billing"]
        ADM1["/api/admin/models  
              ‚Üí Redis model_override:*"] --> A_INTENT
        PAY1["/api/payments  
              PayStack / Coinbase"] --> S1b
    end

Below is a **master inventory + consolidation plan** for every file and folder in the *frontend/* tree you posted.
Read it top‚Äëdown once, then follow the **‚ÄúAction‚Äù** column to decide whether to **keep, move, merge or delete**. When you finish, you‚Äôll have **one clean Turborepo** (Next¬†14‚Äëapp router) with a *shared UI package* and *a single Vite ‚Äúplayground‚Äù* for rapid prototyping‚Äîno duplication, no dead code paths.

---

## 1¬†Top‚Äëlevel files (root of¬†`frontend/`)

| Path                       | Role today                          | Action                                                       |
| -------------------------- | ----------------------------------- | ------------------------------------------------------------ |
| `components.json`          | Shadcn code‚Äëgen manifest (Vite app) | **Move** ‚Üí `apps/web/components.json`                        |
| `eslint.config.js`         | Vite lint rules                     | **Merge** into `/HandyWriterz/packages/eslint-config/`       |
| `tailwind.config.ts`       | Tailwind for Vite app               | Keep *temporarily* until migration finishes, then delete     |
| `vite.config.ts` `vitest*` | Vite build + test for legacy app    | **Keep** (playground)                                        |
| `index.html`               | Entry for Vite dev server           | Keep                                                         |
| `pnpm-lock.yaml`           | Root lock file                      | Replace by workspace root lock in Turborepo (already exists) |
| `.env.example`             | FE env sample                       | Merge keys into `apps/web/.env.example`                      |

---

\##¬†2¬†`frontend/src/` ‚ÄØ‚Äîthe **legacy Vite React app**

### 2.1¬†Root TS/JS files

| File            | Purpose               | Action                                                          |
| --------------- | --------------------- | --------------------------------------------------------------- |
| `App.tsx`       | Vite SPA router shell | **KEEP** (playground)                                           |
| `main.tsx`      | Vite entry            | keep                                                            |
| `global.css`    | Tailwind base         | copy to `packages/ui/styles/globals.css` then import in Next.js |
| `vite-env.d.ts` | Vite typing           | keep (playground)                                               |

\###¬†2.2¬†`app/tests/`
Vitest health test; keep for CI sanity while migrating.

### 2.3¬†`components/`

The folder is already subdivided. Proposed mapping:

| Sub‚Äëfolder                                                                                                                                | Representative files | Target package                                                                                         |
| ----------------------------------------------------------------------------------------------------------------------------------------- | -------------------- | ------------------------------------------------------------------------------------------------------ |
| root atoms (`CTA`, `FeatureCard`, `FeatureGrid`, `Header`, `Footer`, `Hero`, `HowItWorks`, `WelcomeScreen`)                               | marketing‚Äëonly       | **Move** ‚Üí `apps/web/app/(marketing)/` or delete if duplicated in Next.js landing                      |
| `admin/ModelConfigPanel.tsx`                                                                                                              | admin UI             | **Move** ‚Üí `apps/web/app/admin/models/page.tsx`                                                        |
| `chat/*` (`ContextUploadMenu`, `MicButton`)                                                                                               | chat input extras    | **Move** ‚Üí `packages/ui/src/components/chat/`                                                          |
| `nav/UserPopover.tsx`                                                                                                                     | avatar popover       | **Move** ‚Üí `packages/ui/src/components/nav/`                                                           |
| `ui/` primitives (button, card, popover, select, textarea ‚Ä¶)                                                                              | Shadcn generated     | **DELETE dupes**; identical versions already live in Turborepo `packages/ui`. Keep only one set there. |
| `FileUploadZone.tsx`                                                                                                                      | drag‚Äëand‚Äëdrop        | **Move** ‚Üí `packages/ui/src/components/chat/`                                                          |
| `AgentActivityDisplay.tsx`, `ActivityTimeline.tsx`, `AgentActivityStream.tsx`, `ChatHistory.tsx`, `ChatMessagesView.tsx`, `InputForm.tsx` | core chat panel      | **Move** ‚Üí `apps/web/app/chat/` directory                                                              |

### 2.4¬†`hooks/`, `lib/`, `store/`

| Folder                                        | Use         | Action                                                                                           |
| --------------------------------------------- | ----------- | ------------------------------------------------------------------------------------------------ |
| `hooks/useDynamicAuth.ts` `useWallet.ts`      | Web3 auth   | **Move** ‚Üí `packages/ui/src/hooks/`                                                              |
| `lib/dynamic.ts, utils.ts, walletProvider.ts` | helper libs | Combine into single `lib/web3.ts` in UI package                                                  |
| `store/usePrefs.ts`                           | Zustand     | Move to `apps/web/src/store` (only for playground) or convert to Next.js server components later |

\###¬†2.5¬†`pages/`

These Vite pages = marketing+dash demos. If you keep the Vite playground, leave them; for production, replicate in Next.js `app/` router and delete here.

---

\##¬†3¬†`frontend/web/HandyWriterz/`‚ÄØ‚Äîthe **Turborepo workspace**

This is the long‚Äëterm keeper.

### 3.1¬†`apps/web/`

| Path                       | Purpose                   | Action                                |
| -------------------------- | ------------------------- | ------------------------------------- |
| `app/layout.tsx`           | Next.js root layout       | Keep                                  |
| `app/page.tsx`             | index (marketing landing) | keep / extend                         |
| `tailwind.config.ts`       | Tailwind shared           | keep; extend with any missing colours |
| `components/providers.tsx` | Theme & Radix provider    | keep                                  |

Add:

```
app/chat/page.tsx          ‚Üí imports ChatPanel from packages/ui
app/originality/[id]/page  ‚Üí Turnitin workbench
app/admin/models/page.tsx  ‚Üí Model config panel
```

\###¬†3.2¬†Packages

| Package                             | Purpose                                    | Action                                                  |
| ----------------------------------- | ------------------------------------------ | ------------------------------------------------------- |
| `packages/ui`                       | Shadcn primitives + shared chat components | **Centralise all UI primitives here** (merge from Vite) |
| `eslint-config` `typescript-config` | base configs                               | keep                                                    |
| `apps/*`                            | only `web` so far                          | keep                                                    |

---

\##¬†4¬†Deduplication summary

| Keep                                                    | Remove                                                   |
| ------------------------------------------------------- | -------------------------------------------------------- |
| **Turborepo** (`frontend/web/HandyWriterz`) ‚Äî prod code | Duplicate Shadcn components from old `src/components/ui` |
| **Vite app** (`frontend/src`) ‚Äî playground/dev only     | any marketing components that get rebuilt in Next.js     |
| single `tailwind.config.ts` at workspace root           | `frontend/tailwind.config.ts` once migration done        |
| single ESLint + TS configs under workspace              | old root `eslint.config.js`, `tsconfig.*.json`           |

---

\##¬†5¬†Updated final structure (after migration)

```
frontend/
‚îî‚îÄ‚îÄ HandyWriterz/              # ‚Üê Turborepo root
    ‚îú‚îÄ‚îÄ apps/
    ‚îÇ   ‚îî‚îÄ‚îÄ web/
    ‚îÇ       ‚îú‚îÄ‚îÄ app/
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chat/page.tsx
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ originality/[traceId]/page.tsx
    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ admin/models/page.tsx
    ‚îÇ       ‚îú‚îÄ‚îÄ components.json
    ‚îÇ       ‚îú‚îÄ‚îÄ tailwind.config.ts
    ‚îÇ       ‚îî‚îÄ‚îÄ next.config.mjs
    ‚îú‚îÄ‚îÄ packages/
    ‚îÇ   ‚îî‚îÄ‚îÄ ui/
    ‚îÇ       ‚îú‚îÄ‚îÄ src/components/
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ui primitives (button, card ‚Ä¶)
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chat/
    ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PromptEditor.tsx
    ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContextUploadMenu.tsx
    ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MicButton.tsx
    ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AgentTimeline.tsx
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ nav/UserPopover.tsx
    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ admin/ModelConfigPanel.tsx
    ‚îÇ       ‚îú‚îÄ‚îÄ src/hooks/
    ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useDynamicAuth.ts
    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ useWallet.ts
    ‚îÇ       ‚îî‚îÄ‚îÄ styles/globals.css
    ‚îú‚îÄ‚îÄ packages/eslint-config/
    ‚îú‚îÄ‚îÄ packages/typescript-config/
    ‚îî‚îÄ‚îÄ turbo.json
playground/                   # optional: old Vite SPA kept for quick demos
    ‚îî‚îÄ‚îÄ (copy of former frontline src)
```

---

\##¬†6¬†What to do next

1. **Move files** following the map (Git¬†`mv` to preserve history).
2. Update **import paths** (`@/components/ui/button` ‚Üí `@ui/button` via `paths` in `tsconfig.json`).
3. Adjust **Tailwind `content`** arrays to include `packages/ui/**/*.{ts,tsx}`.
4. Run `pnpm i && turbo build` ‚Äî both Next.js and playground should compile.
5. Delete duplicate configs once build passes.
6. Add **Playwright test** ensuring `/chat` renders from Next.js route.

After this sweep, the frontend tree is coherent: **Next.js (prod) + UI monorepo package** with zero duplication; the old Vite SPA remains only as an optional sandbox until the whole team feels comfortable deleting it.

